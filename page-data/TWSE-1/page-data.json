{
    "componentChunkName": "component---src-templates-post-jsx",
    "path": "/TWSE-1/",
    "result": {"data":{"site":{"siteMetadata":{"title":"RN"}},"markdownRemark":{"id":"84f12206-b35b-569c-9a52-90932eba4126","excerpt":"TWSEè‚¡ç¥¨è³‡æ–™ 1 å€‹è‚¡æœˆæˆäº¤è³‡è¨Š å€‹è‚¡æœˆæˆäº¤è³‡è¨Šä»¥å°ç©é›»2330ç‚ºä¾‹ é»é¸ åˆ—å°/HTML æ›´æ”¹ html ç‚º jsn æ›´æ”¹ 20200813ç‚º 20200713ï¼Œå³å¯æ‰¾åˆ°7æœˆè³‡æ–™ æ›´æ”¹ stockNo=2330 ç‚º stockNo=1234ï¼Œå³å¯æ‰¾åˆ°é»‘æ¾äº¤æ˜“è³‡ https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=jsn&date=20200713&stockNo=2330 https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=jsn&date=20200713&stockNo=1234 åœ¨exchangeReportå‰åŠ ä¸Š /en/ è½‰æ›æˆè‹±æ–‡ç‰ˆ https://www.twse.com.tw/en/exchangeReport/STOCK_DAY?response=jsn&date=20200713&stockNo=1234 2 æ¯æ—¥æ”¶ç›¤è¡Œæƒ… æ¯æ—¥æ”¶ç›¤è¡Œæƒ…-å…¨éƒ¨ é»é¸ åˆ—å°/HTML æ›´æ”¹ html ç‚º jsn æ›´æ”¹ 20200827 ç‚º 202008â€¦","html":"<h2>TWSEè‚¡ç¥¨è³‡æ–™</h2>\n<h3>1 å€‹è‚¡æœˆæˆäº¤è³‡è¨Š</h3>\n<ol>\n<li>\n<p><a href=\"https://www.twse.com.tw/zh/page/trading/exchange/STOCK_DAY.html\">å€‹è‚¡æœˆæˆäº¤è³‡è¨Š</a>ä»¥å°ç©é›»2330ç‚ºä¾‹</p>\n</li>\n<li>\n<p>é»é¸ <a href=\"https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=html&#x26;date=20200813&#x26;stockNo=2330\">åˆ—å°/HTML</a></p>\n</li>\n<li>\n<p>æ›´æ”¹ <strong>html</strong> ç‚º <strong>jsn</strong></p>\n</li>\n<li>\n<p>æ›´æ”¹ <a href=\"https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=jsn&#x26;date=20200813&#x26;stockNo=2330\"><strong>20200813</strong></a>ç‚º <a href=\"https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=jsn&#x26;date=20200713&#x26;stockNo=2330\"><strong>20200713</strong></a>ï¼Œå³å¯æ‰¾åˆ°7æœˆè³‡æ–™</p>\n</li>\n<li>\n<p>æ›´æ”¹ <strong>stockNo=2330</strong> ç‚º <strong>stockNo=1234</strong>ï¼Œå³å¯æ‰¾åˆ°é»‘æ¾äº¤æ˜“è³‡</p>\n<blockquote>\n<p><a href=\"https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=jsn&#x26;date=20200713&#x26;stockNo=2330\">https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=jsn&#x26;date=20200713&#x26;stockNo=2330</a></p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=jsn&#x26;date=20200713&#x26;stockNo=1234\">https://www.twse.com.tw/exchangeReport/STOCK_DAY?response=jsn&#x26;date=20200713&#x26;stockNo=1234</a></p>\n</blockquote>\n</li>\n<li>\n<p>åœ¨<strong>exchangeReport</strong>å‰åŠ ä¸Š <strong>/en/</strong> è½‰æ›æˆè‹±æ–‡ç‰ˆ</p>\n<blockquote>\n<p><a href=\"https://www.twse.com.tw/en/exchangeReport/STOCK_DAY?response=jsn&#x26;date=20200713&#x26;stockNo=1234\">https://www.twse.com.tw/en/exchangeReport/STOCK_DAY?response=jsn&#x26;date=20200713&#x26;stockNo=1234</a></p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">stock_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1234</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2330</span><span class=\"token punctuation\">]</span>\ndate <span class=\"token operator\">=</span> <span class=\"token number\">20200813</span>\n<span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>stock_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://www.twse.com.tw/en/exchangeReport/STOCK_DAY?response=jsn&amp;date={}&amp;stockNo={}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">,</span>stock_list<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span> </code></pre></div>\n</li>\n</ol>\n<hr>\n<h3>2 æ¯æ—¥æ”¶ç›¤è¡Œæƒ…</h3>\n<ol>\n<li>\n<p><a href=\"https://www.twse.com.tw/zh/page/trading/exchange/MI_INDEX.html\">æ¯æ—¥æ”¶ç›¤è¡Œæƒ…-å…¨éƒ¨</a></p>\n</li>\n<li>\n<p>é»é¸ åˆ—å°/HTML</p>\n</li>\n<li>\n<p>æ›´æ”¹ <strong>html</strong> ç‚º <strong>jsn</strong></p>\n</li>\n<li>\n<p>æ›´æ”¹ <a href=\"https://www.twse.com.tw/exchangeReport/MI_INDEX?response=jsn&#x26;date=20200728&#x26;type=ALL\"><strong>20200827</strong></a> ç‚º <a href=\"https://www.twse.com.tw/exchangeReport/MI_INDEX?response=jsn&#x26;date=20200828&#x26;type=ALL\"><strong>20200828</strong></a>ï¼Œå³å¯æ‰¾åˆ°8æœˆ28æ—¥è³‡æ–™</p>\n</li>\n<li>\n<p>åœ¨<strong>exchangeReport</strong>å‰åŠ ä¸Š <strong>/en/</strong> è½‰æ›æˆè‹±æ–‡ç‰ˆ</p>\n<blockquote>\n<p><a href=\"https://www.twse.com.tw/en/exchangeReport/MI_INDEX?response=jsn&#x26;date=20200828&#x26;type=ALL\">https://www.twse.com.tw/en/exchangeReport/MI_INDEX?response=jsn&#x26;date=20200828&#x26;type=ALL</a></p>\n</blockquote>\n</li>\n</ol>\n<hr>\n<h2>è§£æJsonæª”</h2>\n<h3>1 å€‹è‚¡æœˆæˆäº¤è³‡è¨Š/en/</h3>\n<h4>1 è§£æ</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">,</span> json \n\nstock_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2330</span><span class=\"token punctuation\">]</span>\ndate <span class=\"token operator\">=</span> <span class=\"token number\">20200813</span>\n\n<span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>stock_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://www.twse.com.tw/en/exchangeReport/STOCK_DAY?response=jsn&amp;date={}&amp;stockNo={}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">,</span>stock_list<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n   <span class=\"token keyword\">with</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> jsonfile<span class=\"token punctuation\">:</span>\n\n       data <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>jsonfile<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n       <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span> </code></pre></div>\n<h4>2 <a href=\"https://jsonformatter.org/json-editor\">Json Editor</a></h4>\n<p><img src=\"https://i.imgur.com/1ohrpxY.jpg\" alt=\"Json Editor\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'fields'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'date'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'title'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h4>3 ä»¥DataFrameå‘ˆç¾è³‡æ–™</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\n<span class=\"token comment\"># DataFrameå‘ˆç¾</span>\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> \n \n<span class=\"token comment\"># è¨­å®šæ¬„ä½</span>\ndf<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">'fields'</span><span class=\"token punctuation\">]</span>\n \n<span class=\"token comment\"># å¢åŠ Stock Codeè‡³df</span>\ndf<span class=\"token punctuation\">[</span><span class=\"token string\">\"Stock Code\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> stock_list<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n \n<span class=\"token comment\"># å°‡Stock Code è¨­ç‚º index</span>\ndf <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>set_index<span class=\"token punctuation\">(</span><span class=\"token string\">'Stock Code'</span><span class=\"token punctuation\">)</span>\n \n<span class=\"token comment\"># å°‡é€—è™Ÿæ‹¿æ‰</span>\ndf <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>applymap<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5># å®Œæ•´ç¨‹å¼ç¢¼</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">,</span> json\n\nstock_list <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2330</span><span class=\"token punctuation\">]</span>\ndate <span class=\"token operator\">=</span> <span class=\"token number\">20200813</span>\n<span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>stock_list<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n   url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://www.twse.com.tw/en/exchangeReport/STOCK_DAY?response=jsn&amp;date={}&amp;stockNo={}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">,</span>stock_list<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n   <span class=\"token keyword\">with</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> jsonfile<span class=\"token punctuation\">:</span>\n       data <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>jsonfile<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n       df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n       df<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">'fields'</span><span class=\"token punctuation\">]</span>\n       df<span class=\"token punctuation\">[</span><span class=\"token string\">\"Stock Code\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> stock_list<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span>\n       df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>set_index<span class=\"token punctuation\">(</span><span class=\"token string\">'Stock Code'</span><span class=\"token punctuation\">)</span>\n       df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>applymap<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ndf </code></pre></div>\n<hr>\n<h3>2 æ¯æ—¥æ”¶ç›¤è¡Œæƒ…</h3>\n<h4>è§£æJsonæª”</h4>\n<h5>1 è§£æ</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">,</span> json\n<span class=\"token keyword\">import</span> datetime\n\ndate <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://www.twse.com.tw/exchangeReport/MI_INDEX?response=jsn&amp;date={}&amp;type=ALL\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> jsonfile<span class=\"token punctuation\">:</span>\n    data <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>jsonfile<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'fields9'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data9'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h5>2 ä»¥DataFrameå‘ˆç¾</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data9'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data9'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ndf<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">'fields9'</span><span class=\"token punctuation\">]</span> </code></pre></div>\n<h5>3 å°‡æ¼²è·Œ(+/-)åˆªé™¤</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span>columns <span class=\"token operator\">=</span> <span class=\"token string\">'æ¼²è·Œ(+/-)'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5>4 å°‡è­‰åˆ¸ä»£è™Ÿè¨­ç‚ºindex</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>set_index<span class=\"token punctuation\">(</span><span class=\"token string\">'è­‰åˆ¸ä»£è™Ÿ'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5>5 å°‡é€—è™Ÿæ‹¿æ‰</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>applymap<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5>6 åŠ å…¥æ—¥æœŸ</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">[</span><span class=\"token string\">\"æ—¥æœŸ\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h5># å®Œæ•´ç¨‹å¼ç¢¼</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">,</span> json\n<span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd\n<span class=\"token keyword\">import</span> datetime\n\ndate <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">.</span>datetime<span class=\"token punctuation\">.</span>now<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nurl <span class=\"token operator\">=</span> <span class=\"token string\">\"https://www.twse.com.tw/exchangeReport/MI_INDEX?response=jsn&amp;date={}&amp;type=ALL\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">with</span> urllib<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">.</span>urlopen<span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> jsonfile<span class=\"token punctuation\">:</span>\n    data <span class=\"token operator\">=</span> json<span class=\"token punctuation\">.</span>loads<span class=\"token punctuation\">(</span>jsonfile<span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>decode<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>DataFrame<span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data9'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">:</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">[</span><span class=\"token string\">'data9'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    df<span class=\"token punctuation\">.</span>columns <span class=\"token operator\">=</span> data<span class=\"token punctuation\">[</span><span class=\"token string\">'fields9'</span><span class=\"token punctuation\">]</span>\n    df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span>columns <span class=\"token operator\">=</span> <span class=\"token string\">'æ¼²è·Œ(+/-)'</span><span class=\"token punctuation\">)</span>\n    df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>set_index<span class=\"token punctuation\">(</span><span class=\"token string\">'è­‰åˆ¸ä»£è™Ÿ'</span><span class=\"token punctuation\">)</span>\n    df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>applymap<span class=\"token punctuation\">(</span><span class=\"token keyword\">lambda</span> x<span class=\"token punctuation\">:</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">,</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    df<span class=\"token punctuation\">[</span><span class=\"token string\">\"æ—¥æœŸ\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span>\ndf</code></pre></div>","frontmatter":{"title":"ğŸ“ˆ TWSE-1-jsonæª”è§£æ","date":"November 27, 2020","update":null,"tags":["TWSE"],"series":null},"fields":{"slug":"/TWSE-1/","readingTime":{"minutes":2.655}}},"seriesList":{"edges":[{"node":{"id":"84f12206-b35b-569c-9a52-90932eba4126","fields":{"slug":"/TWSE-1/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-1-jsonæª”è§£æ"}}},{"node":{"id":"98ac704b-948d-5e27-b018-5e74d19a2321","fields":{"slug":"/TWSE-2/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-2-å°‡DataFrameå­˜å…¥CSVæª” & æŠ“å–å¤šç­†è³‡æ–™"}}},{"node":{"id":"cbc00f9f-691d-55bb-b94d-9626ccd82c85","fields":{"slug":"/TWSE-3/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-3-TWSEçš„è³‡æ–™å­˜å…¥SQLite"}}},{"node":{"id":"86351f17-7bd3-5d53-b5c0-b8a09c915143","fields":{"slug":"/TWSE-4/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-4-è³‡æ–™å­˜å…¥MySQLåŠå–å‡º"}}},{"node":{"id":"fb2f8d77-486a-51de-be15-df09463393a8","fields":{"slug":"/TWSE-5/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-5-mpl_finance Kç·šåœ–"}}},{"node":{"id":"f61afa98-58c0-5b78-8a49-d195b14ad223","fields":{"slug":"/TWSE-6/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-6-MySQL to Dataframe & mplfinance Kç·šåœ–"}}},{"node":{"id":"a02d0528-84ff-5573-b188-9292da9a5fda","fields":{"slug":"/TWSE-7/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-7-Interactive Candlestick Charts"}}},{"node":{"id":"d6651b52-be20-5a3d-87a8-b8036f1bff68","fields":{"slug":"/TWSE-8/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-8-plotly | Chart Studio | 1"}}},{"node":{"id":"354205b6-2680-5494-9688-421c384c2e7c","fields":{"slug":"/TWSE-9/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-9-Bs4 + é‰…äº¨ç¶²"}}},{"node":{"id":"c5dd3d84-ee79-50ff-bbb7-4081479a3c49","fields":{"slug":"/TWSE-10-1/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-10-1-MongoDB+Python"}}},{"node":{"id":"891d93d2-e527-5635-bfb0-23c478c5e65f","fields":{"slug":"/TWSE-10-2/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-10-2-MongoDB+Python"}}},{"node":{"id":"cb12e004-6706-503c-be88-311feff22a6c","fields":{"slug":"/TWSE-10-3/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-10-3-MongoDB+Python"}}},{"node":{"id":"5891f396-11aa-55b9-b766-888ed2c6814f","fields":{"slug":"/TWSE-10-4/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-10-4-MongoDB+Python"}}},{"node":{"id":"8b6644eb-6972-55ca-8d28-d43250b9b5d7","fields":{"slug":"/TWSE-11/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-11-Wordcloud + MongoDB"}}},{"node":{"id":"16e41194-8361-5114-8171-1bebe6f4c75e","fields":{"slug":"/TWSE-12/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-12-Efficient Frontier"}}},{"node":{"id":"b2d27c4b-8019-5ba4-923d-8e66c8772c61","fields":{"slug":"/TWSE-13/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-13-Selenium + é‰…äº¨ç¶²"}}},{"node":{"id":"686b1422-7e63-516f-a3a1-30b86e86aa8c","fields":{"slug":"/About/"},"frontmatter":{"title":"ğŸ˜¶ About"}}},{"node":{"id":"51baac29-b12a-5cdc-ae5b-db1fa86fe935","fields":{"slug":"/C-1/"},"frontmatter":{"title":"ğŸ–¥ï¸ C-Set up Visual Studio Code"}}},{"node":{"id":"4dd46789-25c7-56ec-869d-d4114e3f7c71","fields":{"slug":"/VSCode-imgur/"},"frontmatter":{"title":"ğŸ–¥ï¸ Visual Studio Code + Imgur"}}},{"node":{"id":"1b91a9d3-1f8a-5c85-8423-9b119011250b","fields":{"slug":"/OCW/"},"frontmatter":{"title":"ğŸ““ Online Course"}}},{"node":{"id":"9e148609-92c6-5429-8913-89c5b9ff96bc","fields":{"slug":"/projects/"},"frontmatter":{"title":"ğŸ’¼ Projects"}}},{"node":{"id":"1af50d73-8f14-52c1-9da7-a27f5b7b3cae","fields":{"slug":"/Santander-Customer-Satisfaction/"},"frontmatter":{"title":"ğŸ… Santander Customer Satisfaction"}}},{"node":{"id":"6436c9fe-28ac-5565-8857-564eda123d31","fields":{"slug":"/torchstudio/"},"frontmatter":{"title":"ğŸ–¥ï¸ torchstudio"}}},{"node":{"id":"8c3a5f31-3dc2-525e-bba8-5641fe5e1e24","fields":{"slug":"/Neo4j/"},"frontmatter":{"title":"ğŸ–¥ï¸ Neo4j"}}},{"node":{"id":"8d1c35a3-682b-5993-bc72-ca7156680598","fields":{"slug":"/MongoDB-Query-Operators/"},"frontmatter":{"title":"ğŸ–¥ï¸ MongoDB Query Operators"}}}]},"previous":null,"next":{"fields":{"slug":"/TWSE-2/"},"frontmatter":{"title":"ğŸ“ˆ TWSE-2-å°‡DataFrameå­˜å…¥CSVæª” & æŠ“å–å¤šç­†è³‡æ–™"}}},"pageContext":{"id":"84f12206-b35b-569c-9a52-90932eba4126","series":null,"previousPostId":null,"nextPostId":"98ac704b-948d-5e27-b018-5e74d19a2321"}},
    "staticQueryHashes": []}