{
    "componentChunkName": "component---src-templates-post-jsx",
    "path": "/TWSE-6/",
    "result": {"data":{"site":{"siteMetadata":{"title":"RN"}},"markdownRemark":{"id":"f61afa98-58c0-5b78-8a49-d195b14ad223","excerpt":"SQL連線 讀取資料庫Table至Dataframe 1 取出指定col值 2 取出指定index值 3 取出指定index and col值 4 取出多個col值 5 欄位名稱 6 資料 7 欄位Type 8 index值 9 重新命名 # 實作 讀取指定index值至Dataframe mplfinance [新版] 每日收盤行情 SQL連線 重新調整Dataframe 1 刪掉多餘的Col 2 重新命名Col 3 df['Date']型態改變 4 重新排序 Candlestick chart 基本 美化 免連SQL版 基本 美化 MACD","html":"<div style=\"text-align: right\" Icons made by <a href=\"https://www.flaticon.com/authors/freepik\" title=\"Freepik\">Freepik</a> from <a href=\"https://www.flaticon.com/\" title=\"Flaticon\">www.flaticon.com</a></div>\n<h1 style = \"font-family: Verdana;font-weight: 600;\">MySQL to Dataframe\n</h1>\n<h2>SQL連線</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">user <span class=\"token operator\">=</span> <span class=\"token string\">'root'</span>\npw <span class=\"token operator\">=</span> <span class=\"token string\">\"YourPassworrd\"</span>\n\nconn<span class=\"token operator\">=</span>MySQLdb<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span>user<span class=\"token operator\">=</span>user<span class=\"token punctuation\">,</span> passwd<span class=\"token operator\">=</span>pw<span class=\"token punctuation\">,</span>charset<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span>\ncursor<span class=\"token operator\">=</span>conn<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n\ncursor<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"CREATE DATABASE IF NOT EXISTS TWSE DEFAULT CHARSET=utf8 DEFAULT COLLATE=utf8_unicode_ci\"</span> <span class=\"token punctuation\">)</span>\nengine <span class=\"token operator\">=</span> create_engine<span class=\"token punctuation\">(</span><span class=\"token string\">\"mysql+pymysql://{}:{}@localhost/{db}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span>pw<span class=\"token punctuation\">,</span>db<span class=\"token operator\">=</span><span class=\"token string\">\"TWSE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_sql<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT* FROM `twse` WHERE `Stock Code` = 2330 AND `Date` BETWEEN '2019/11/10 00:00:00' AND '2020/1/10 23:59:59'\"</span><span class=\"token punctuation\">,</span> engine<span class=\"token punctuation\">,</span> coerce_float<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> parse_dates<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h2>讀取資料庫Table至Dataframe</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas <span class=\"token keyword\">as</span> pd \n\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_sql<span class=\"token punctuation\">(</span><span class=\"token string\">'SELECT* FROM `twse`'</span><span class=\"token punctuation\">,</span> engine<span class=\"token punctuation\">,</span> index_col<span class=\"token operator\">=</span> <span class=\"token string\">'Stock Code'</span><span class=\"token punctuation\">,</span> coerce_float<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> parse_dates<span class=\"token operator\">=</span><span class=\"token string\">'Date'</span><span class=\"token punctuation\">)</span>\ndf </code></pre></div>\n<h3>1 取出指定col值</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Opening Price'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h3>2 取出指定index值</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token string\">'2330'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>3 取出指定index and col值</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">.</span>loc<span class=\"token punctuation\">[</span><span class=\"token string\">'2330'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Opening Price'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h3>4 取出多個col值</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Opening Price'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Closing Price'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span> </code></pre></div>\n<h3>5 欄位名稱</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>columns </code></pre></div>\n<h3>6 資料</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>values</code></pre></div>\n<h3>7 欄位Type</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>dtypes</code></pre></div>\n<h3>8 index值</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>index</code></pre></div>\n<h3>9 重新命名</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">.</span>rename<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'Opening Price'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Open'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h3># 實作</h3>\n<blockquote>\n<p>讀取指定index值至Dataframe</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_sql<span class=\"token punctuation\">(</span><span class=\"token string\">'SELECT* FROM `twse`, engine, index_col= '</span>Stock Code<span class=\"token string\">', coerce_float=True, parse_dates='</span>Date'<span class=\"token punctuation\">)</span>  </code></pre></div>\n<h2>mplfinance [新版]</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">pip install mplfinance</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> mplfinance <span class=\"token keyword\">as</span> mpf </code></pre></div>\n<h3>每日收盤行情</h3>\n<h4>SQL連線</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">user <span class=\"token operator\">=</span> <span class=\"token string\">'root'</span>\npw <span class=\"token operator\">=</span> <span class=\"token string\">\"YourPassworrd\"</span>\n\nconn<span class=\"token operator\">=</span>MySQLdb<span class=\"token punctuation\">.</span>connect<span class=\"token punctuation\">(</span>host<span class=\"token operator\">=</span><span class=\"token string\">\"127.0.0.1\"</span><span class=\"token punctuation\">,</span>user<span class=\"token operator\">=</span>user<span class=\"token punctuation\">,</span> passwd<span class=\"token operator\">=</span>pw<span class=\"token punctuation\">,</span>charset<span class=\"token operator\">=</span><span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span>\ncursor<span class=\"token operator\">=</span>conn<span class=\"token punctuation\">.</span>cursor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> \n\ncursor<span class=\"token punctuation\">.</span>execute<span class=\"token punctuation\">(</span><span class=\"token string\">\"CREATE DATABASE IF NOT EXISTS TWSE DEFAULT CHARSET=utf8 DEFAULT COLLATE=utf8_unicode_ci\"</span> <span class=\"token punctuation\">)</span>\nengine <span class=\"token operator\">=</span> create_engine<span class=\"token punctuation\">(</span><span class=\"token string\">\"mysql+pymysql://{}:{}@localhost/{db}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">,</span>pw<span class=\"token punctuation\">,</span>db<span class=\"token operator\">=</span><span class=\"token string\">\"TWSE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ndf <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>read_sql<span class=\"token punctuation\">(</span><span class=\"token string\">\"SELECT* FROM `twse` WHERE `Stock Code` = 2330 AND `Date` BETWEEN '2019/11/10 00:00:00' AND '2020/1/10 23:59:59'\"</span><span class=\"token punctuation\">,</span> engine<span class=\"token punctuation\">,</span> coerce_float<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> parse_dates<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h4>重新調整Dataframe</h4>\n<h5>1 刪掉多餘的Col</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>drop<span class=\"token punctuation\">(</span>columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Stock Code'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Change'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Transaction'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Trade Value'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5>2 重新命名Col</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>rename<span class=\"token punctuation\">(</span>columns <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string\">'Opening Price'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Open'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Highest Price'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'High'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Closing Price'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'Close'</span><span class=\"token punctuation\">,</span>\n                       <span class=\"token string\">'Lowest Price'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'Low'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Closing Price'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'Close'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Trade Volume'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h5>3 df['Date']型態改變</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">df<span class=\"token punctuation\">[</span><span class=\"token string\">'Date'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> pd<span class=\"token punctuation\">.</span>to_datetime<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Date'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<h5>4 重新排序</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">neworder <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'Open'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'High'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Low'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Close'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span>\ndf <span class=\"token operator\">=</span> df<span class=\"token punctuation\">.</span>reindex<span class=\"token punctuation\">(</span>columns<span class=\"token operator\">=</span>neworder<span class=\"token punctuation\">)</span> </code></pre></div>\n<h4>Candlestick chart</h4>\n<h5>基本</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">mpf<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span><span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'candle'</span><span class=\"token punctuation\">)</span> </code></pre></div>\n<img src='https://i.imgur.com/ZHQOYJH.png' width='100%'>\n<h5>美化</h5>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">mc <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>make_marketcolors<span class=\"token punctuation\">(</span>up<span class=\"token operator\">=</span><span class=\"token string\">'#5ac390'</span><span class=\"token punctuation\">,</span>down<span class=\"token operator\">=</span><span class=\"token string\">'#fd6a6c'</span><span class=\"token punctuation\">,</span>volume<span class=\"token operator\">=</span><span class=\"token string\">'in'</span><span class=\"token punctuation\">,</span>edge<span class=\"token operator\">=</span><span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span>\n\ns  <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>make_mpf_style<span class=\"token punctuation\">(</span>base_mpl_style<span class=\"token operator\">=</span><span class=\"token string\">'fivethirtyeight'</span><span class=\"token punctuation\">,</span>gridstyle<span class=\"token operator\">=</span><span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span>marketcolors<span class=\"token operator\">=</span>mc<span class=\"token punctuation\">)</span>\n\nfig <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>style<span class=\"token operator\">=</span>s<span class=\"token punctuation\">,</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nax1 <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_axes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax2 <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_axes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmav<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\n\nmpf<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span>\n         <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'candle'</span><span class=\"token punctuation\">,</span>\n         style<span class=\"token operator\">=</span>s<span class=\"token punctuation\">,</span>\n         volume<span class=\"token operator\">=</span>ax2<span class=\"token punctuation\">,</span>\n         mav<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         panel_ratios<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         xrotation<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         ax <span class=\"token operator\">=</span> ax1<span class=\"token punctuation\">,</span>\n         update_width_config <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>candle_width <span class=\"token operator\">=</span> <span class=\"token number\">0.95</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         scale_width_adjustment <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>lines<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nax1<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n           loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">,</span> bbox_to_anchor<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n           fontsize <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n           frameon <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n           edgecolor <span class=\"token operator\">=</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">,</span>\n           facecolor <span class=\"token operator\">=</span> <span class=\"token string\">'w'</span>\n           <span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>set_title<span class=\"token punctuation\">(</span>\n    label <span class=\"token operator\">=</span> <span class=\"token string\">'\\nTWSE\\n\\nStock Code:2330\\n'</span><span class=\"token punctuation\">,</span>\n    fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'fontsize'</span><span class=\"token punctuation\">:</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n              <span class=\"token string\">'fontweight'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token string\">'color'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'k'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    loc<span class=\"token operator\">=</span><span class=\"token string\">'center'</span>\n             <span class=\"token punctuation\">)</span>\n\nax1<span class=\"token punctuation\">.</span>set_ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'Price'</span><span class=\"token punctuation\">,</span>fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'weight'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'size'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span>set_ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">,</span>fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'weight'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'size'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nax1<span class=\"token punctuation\">.</span>yaxis<span class=\"token punctuation\">.</span>set_label_position<span class=\"token punctuation\">(</span><span class=\"token string\">\"left\"</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>yaxis<span class=\"token punctuation\">.</span>tick_left<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nyticks <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span>set_yticks<span class=\"token punctuation\">(</span>yticks<span class=\"token punctuation\">)</span></code></pre></div>\n<img src='https://i.imgur.com/VvxKi2a.png' width='100%'>\n<h3>免連SQL版</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> pandas_datareader<span class=\"token punctuation\">.</span>data <span class=\"token keyword\">as</span> web\n<span class=\"token keyword\">import</span> mplfinance <span class=\"token keyword\">as</span> mpf\n<span class=\"token keyword\">from</span> IPython<span class=\"token punctuation\">.</span>display <span class=\"token keyword\">import</span> Image\n\nstock_code <span class=\"token operator\">=</span> <span class=\"token string\">'0050.tw'</span>\n\ndf <span class=\"token operator\">=</span> web<span class=\"token punctuation\">.</span>DataReader<span class=\"token punctuation\">(</span>stock_code<span class=\"token punctuation\">,</span> <span class=\"token string\">'yahoo'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2020-11-01'</span><span class=\"token punctuation\">)</span>\ndf <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token string\">'Open'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'High'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Low'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Close'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<h4>基本</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">mpf<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span> <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'candle'</span><span class=\"token punctuation\">,</span> mav<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> volume<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> title<span class=\"token operator\">=</span><span class=\"token string\">'\\n{stock_code}'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>stock_code<span class=\"token operator\">=</span>stock_code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> savefig<span class=\"token operator\">=</span><span class=\"token string\">'test_1.png'</span><span class=\"token punctuation\">)</span>\n\nImage<span class=\"token punctuation\">(</span><span class=\"token string\">'test_1.png'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<img src='https://i.imgur.com/ipGw9KV.png' width='100%'>\n<h4>美化</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt \n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\nmc <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>make_marketcolors<span class=\"token punctuation\">(</span>up<span class=\"token operator\">=</span><span class=\"token string\">'#5ac390'</span><span class=\"token punctuation\">,</span>down<span class=\"token operator\">=</span><span class=\"token string\">'#fd6a6c'</span><span class=\"token punctuation\">,</span>volume<span class=\"token operator\">=</span><span class=\"token string\">'in'</span><span class=\"token punctuation\">,</span>edge<span class=\"token operator\">=</span><span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span>\ns  <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>make_mpf_style<span class=\"token punctuation\">(</span>base_mpl_style<span class=\"token operator\">=</span><span class=\"token string\">'fivethirtyeight'</span><span class=\"token punctuation\">,</span>gridstyle<span class=\"token operator\">=</span><span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span>marketcolors<span class=\"token operator\">=</span>mc<span class=\"token punctuation\">)</span>\n\nfig <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>style<span class=\"token operator\">=</span>s<span class=\"token punctuation\">,</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nax1 <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_axes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.95</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax2 <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_axes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.95</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmav <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\nmpf<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span>\n         <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'candle'</span><span class=\"token punctuation\">,</span>\n         style<span class=\"token operator\">=</span>s<span class=\"token punctuation\">,</span>\n         volume<span class=\"token operator\">=</span>ax2<span class=\"token punctuation\">,</span>\n         mav<span class=\"token operator\">=</span>mav<span class=\"token punctuation\">,</span>\n         panel_ratios<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         xrotation<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         ax <span class=\"token operator\">=</span> ax1<span class=\"token punctuation\">,</span>\n         update_width_config <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>candle_width <span class=\"token operator\">=</span> <span class=\"token number\">0.95</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         scale_width_adjustment <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>lines<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nax1<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n           loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">,</span> \n           bbox_to_anchor<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n           fontsize <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n           frameon <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n           edgecolor <span class=\"token operator\">=</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">,</span>\n           facecolor <span class=\"token operator\">=</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>\n\nax1<span class=\"token punctuation\">.</span>set_title<span class=\"token punctuation\">(</span>\n    label <span class=\"token operator\">=</span> <span class=\"token string\">'\\n\\nStock Code:{}\\n'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>stock_code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'fontsize'</span><span class=\"token punctuation\">:</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n              <span class=\"token string\">'fontweight'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token string\">'color'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'k'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    loc<span class=\"token operator\">=</span><span class=\"token string\">'center'</span><span class=\"token punctuation\">)</span>\n\nax1<span class=\"token punctuation\">.</span>set_xticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>set_ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'Price'</span><span class=\"token punctuation\">,</span>fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'weight'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'size'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span>set_ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">,</span>fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'weight'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'size'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\nax1<span class=\"token punctuation\">.</span>yaxis<span class=\"token punctuation\">.</span>set_label_position<span class=\"token punctuation\">(</span><span class=\"token string\">\"left\"</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>yaxis<span class=\"token punctuation\">.</span>tick_left<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nyticks <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span>set_yticks<span class=\"token punctuation\">(</span>yticks<span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>savefig<span class=\"token punctuation\">(</span><span class=\"token string\">'test_2.png'</span><span class=\"token punctuation\">,</span> dpi<span class=\"token operator\">=</span><span class=\"token number\">300</span><span class=\"token punctuation\">)</span></code></pre></div>\n<img src='https://i.imgur.com/EAGyL8V.png' width='100%'>\n<h4>MACD</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt \n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\nmc <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>make_marketcolors<span class=\"token punctuation\">(</span>up<span class=\"token operator\">=</span><span class=\"token string\">'#5ac390'</span><span class=\"token punctuation\">,</span>down<span class=\"token operator\">=</span><span class=\"token string\">'#fd6a6c'</span><span class=\"token punctuation\">,</span>volume<span class=\"token operator\">=</span><span class=\"token string\">'in'</span><span class=\"token punctuation\">,</span>edge<span class=\"token operator\">=</span><span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span>\ns  <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>make_mpf_style<span class=\"token punctuation\">(</span>base_mpl_style<span class=\"token operator\">=</span><span class=\"token string\">'fivethirtyeight'</span><span class=\"token punctuation\">,</span>gridstyle<span class=\"token operator\">=</span><span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span>marketcolors<span class=\"token operator\">=</span>mc<span class=\"token punctuation\">)</span>\n\nmc <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>make_marketcolors<span class=\"token punctuation\">(</span>up<span class=\"token operator\">=</span><span class=\"token string\">'#5ac390'</span><span class=\"token punctuation\">,</span>down<span class=\"token operator\">=</span><span class=\"token string\">'#fd6a6c'</span><span class=\"token punctuation\">,</span>volume<span class=\"token operator\">=</span><span class=\"token string\">'in'</span><span class=\"token punctuation\">,</span>edge<span class=\"token operator\">=</span><span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">)</span>\ns  <span class=\"token operator\">=</span> mpf<span class=\"token punctuation\">.</span>make_mpf_style<span class=\"token punctuation\">(</span>base_mpl_style<span class=\"token operator\">=</span><span class=\"token string\">'fivethirtyeight'</span><span class=\"token punctuation\">,</span>gridstyle<span class=\"token operator\">=</span><span class=\"token string\">'None'</span><span class=\"token punctuation\">,</span>marketcolors<span class=\"token operator\">=</span>mc<span class=\"token punctuation\">)</span>\n\nexp12 <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'Close'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ewm<span class=\"token punctuation\">(</span>span<span class=\"token operator\">=</span><span class=\"token number\">12</span><span class=\"token punctuation\">,</span> adjust<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nexp26 <span class=\"token operator\">=</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'Close'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>ewm<span class=\"token punctuation\">(</span>span<span class=\"token operator\">=</span><span class=\"token number\">26</span><span class=\"token punctuation\">,</span> adjust<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\nmacd <span class=\"token operator\">=</span> exp12 <span class=\"token operator\">-</span> exp26\n\nsignal    <span class=\"token operator\">=</span> macd<span class=\"token punctuation\">.</span>ewm<span class=\"token punctuation\">(</span>span<span class=\"token operator\">=</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span> adjust<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nhistogram <span class=\"token operator\">=</span> macd <span class=\"token operator\">-</span> signal\n\nfig <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">20</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nax1 <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_axes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.94</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax2 <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_axes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.015</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.94</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax3 <span class=\"token operator\">=</span> fig<span class=\"token punctuation\">.</span>add_axes<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0.05</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.94</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nstrDate <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token string\">' '</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> e <span class=\"token keyword\">in</span> df<span class=\"token punctuation\">[</span><span class=\"token string\">'Close'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">]</span>\nplt<span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">(</span>strDate<span class=\"token punctuation\">,</span> histogram<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'#7f7f7f'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>strDate<span class=\"token punctuation\">,</span> macd<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>strDate<span class=\"token punctuation\">,</span> signal<span class=\"token punctuation\">,</span> color <span class=\"token operator\">=</span> <span class=\"token string\">'r'</span><span class=\"token punctuation\">)</span>\n\nmav <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>\nmpf<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">,</span>\n         <span class=\"token builtin\">type</span><span class=\"token operator\">=</span><span class=\"token string\">'candle'</span><span class=\"token punctuation\">,</span>\n         style<span class=\"token operator\">=</span>s<span class=\"token punctuation\">,</span>\n         volume<span class=\"token operator\">=</span>ax2<span class=\"token punctuation\">,</span>\n         mav<span class=\"token operator\">=</span>mav<span class=\"token punctuation\">,</span>\n         panel_ratios<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         xrotation<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n         ax <span class=\"token operator\">=</span> ax1<span class=\"token punctuation\">,</span>\n         update_width_config <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>candle_width <span class=\"token operator\">=</span> <span class=\"token number\">0.95</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n         scale_width_adjustment <span class=\"token operator\">=</span> <span class=\"token builtin\">dict</span><span class=\"token punctuation\">(</span>lines<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token string\">'mav '</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>mav<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n           loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">,</span> \n           bbox_to_anchor<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n           fontsize <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n           frameon <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n           edgecolor <span class=\"token operator\">=</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">,</span>\n           facecolor <span class=\"token operator\">=</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>\nax3<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'macd'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'signal'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n           loc<span class=\"token operator\">=</span><span class=\"token string\">'best'</span><span class=\"token punctuation\">,</span> \n           bbox_to_anchor<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1.1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n           fontsize <span class=\"token operator\">=</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span>\n           frameon <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n           edgecolor <span class=\"token operator\">=</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">,</span>\n           facecolor <span class=\"token operator\">=</span> <span class=\"token string\">'w'</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>set_title<span class=\"token punctuation\">(</span>\n    label <span class=\"token operator\">=</span> <span class=\"token string\">'MACD\\n\\nStock Code:{}\\n'</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>stock_code<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'fontsize'</span><span class=\"token punctuation\">:</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span>\n              <span class=\"token string\">'fontweight'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span>\n              <span class=\"token string\">'color'</span><span class=\"token punctuation\">:</span><span class=\"token string\">'k'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    loc<span class=\"token operator\">=</span><span class=\"token string\">'center'</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>set_ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'Price'</span><span class=\"token punctuation\">,</span>fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'weight'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'size'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span>set_ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">,</span>fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'weight'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'size'</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>yaxis<span class=\"token punctuation\">.</span>set_label_position<span class=\"token punctuation\">(</span><span class=\"token string\">\"left\"</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>yaxis<span class=\"token punctuation\">.</span>tick_left<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nyticks <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>arange<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">round</span><span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>df<span class=\"token punctuation\">[</span><span class=\"token string\">'Volume'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">5</span> <span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span>set_yticks<span class=\"token punctuation\">(</span>yticks<span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span>set_xticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax3<span class=\"token punctuation\">.</span>set_xticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax1<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>frame_on<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nax2<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>frame_on<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nax3<span class=\"token punctuation\">.</span><span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span>frame_on<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>savefig<span class=\"token punctuation\">(</span><span class=\"token string\">'test_3.png'</span><span class=\"token punctuation\">,</span> dpi<span class=\"token operator\">=</span><span class=\"token number\">300</span><span class=\"token punctuation\">)</span></code></pre></div>\n<img src='https://i.imgur.com/JS50WZs.png' width='100%'>","frontmatter":{"title":"🗠 TWSE-6-MySQL to Dataframe & mplfinance K線圖","date":"November 29, 2020","update":null,"tags":["TWSE"],"series":null},"fields":{"slug":"/TWSE-6/","readingTime":{"minutes":4.025}}},"seriesList":{"edges":[{"node":{"id":"84f12206-b35b-569c-9a52-90932eba4126","fields":{"slug":"/TWSE-1/"},"frontmatter":{"title":"🗠 TWSE-1-json檔解析"}}},{"node":{"id":"98ac704b-948d-5e27-b018-5e74d19a2321","fields":{"slug":"/TWSE-2/"},"frontmatter":{"title":"🗠 TWSE-2-將DataFrame存入CSV檔 & 抓取多筆資料"}}},{"node":{"id":"cbc00f9f-691d-55bb-b94d-9626ccd82c85","fields":{"slug":"/TWSE-3/"},"frontmatter":{"title":"🗠 TWSE-3-TWSE的資料存入SQLite"}}},{"node":{"id":"86351f17-7bd3-5d53-b5c0-b8a09c915143","fields":{"slug":"/TWSE-4/"},"frontmatter":{"title":"🗠 TWSE-4-資料存入MySQL及取出"}}},{"node":{"id":"fb2f8d77-486a-51de-be15-df09463393a8","fields":{"slug":"/TWSE-5/"},"frontmatter":{"title":"🗠 TWSE-5-mpl_finance K線圖"}}},{"node":{"id":"f61afa98-58c0-5b78-8a49-d195b14ad223","fields":{"slug":"/TWSE-6/"},"frontmatter":{"title":"🗠 TWSE-6-MySQL to Dataframe & mplfinance K線圖"}}},{"node":{"id":"a02d0528-84ff-5573-b188-9292da9a5fda","fields":{"slug":"/TWSE-7/"},"frontmatter":{"title":"🗠 TWSE-7-Interactive Candlestick Charts"}}},{"node":{"id":"d6651b52-be20-5a3d-87a8-b8036f1bff68","fields":{"slug":"/TWSE-8/"},"frontmatter":{"title":"🗠 TWSE-8-plotly | Chart Studio | 1"}}},{"node":{"id":"354205b6-2680-5494-9688-421c384c2e7c","fields":{"slug":"/TWSE-9/"},"frontmatter":{"title":"🗠 TWSE-9-Bs4 + 鉅亨網"}}},{"node":{"id":"c5dd3d84-ee79-50ff-bbb7-4081479a3c49","fields":{"slug":"/TWSE-10-1/"},"frontmatter":{"title":"🗠 TWSE-10-1-MongoDB+Python"}}},{"node":{"id":"891d93d2-e527-5635-bfb0-23c478c5e65f","fields":{"slug":"/TWSE-10-2/"},"frontmatter":{"title":"🗠 TWSE-10-2-MongoDB+Python"}}},{"node":{"id":"cb12e004-6706-503c-be88-311feff22a6c","fields":{"slug":"/TWSE-10-3/"},"frontmatter":{"title":"🗠 TWSE-10-3-MongoDB+Python"}}},{"node":{"id":"5891f396-11aa-55b9-b766-888ed2c6814f","fields":{"slug":"/TWSE-10-4/"},"frontmatter":{"title":"🗠 TWSE-10-4-MongoDB+Python"}}},{"node":{"id":"8b6644eb-6972-55ca-8d28-d43250b9b5d7","fields":{"slug":"/TWSE-11/"},"frontmatter":{"title":"🗠 TWSE-11-Wordcloud + MongoDB"}}},{"node":{"id":"16e41194-8361-5114-8171-1bebe6f4c75e","fields":{"slug":"/TWSE-12/"},"frontmatter":{"title":"🗠 TWSE-12-Efficient Frontier"}}},{"node":{"id":"b2d27c4b-8019-5ba4-923d-8e66c8772c61","fields":{"slug":"/TWSE-13/"},"frontmatter":{"title":"🗠 TWSE-13-Selenium + 鉅亨網"}}},{"node":{"id":"686b1422-7e63-516f-a3a1-30b86e86aa8c","fields":{"slug":"/About/"},"frontmatter":{"title":"😶 About"}}}]},"previous":{"fields":{"slug":"/TWSE-5/"},"frontmatter":{"title":"🗠 TWSE-5-mpl_finance K線圖"}},"next":{"fields":{"slug":"/TWSE-7/"},"frontmatter":{"title":"🗠 TWSE-7-Interactive Candlestick Charts"}}},"pageContext":{"id":"f61afa98-58c0-5b78-8a49-d195b14ad223","series":null,"previousPostId":"fb2f8d77-486a-51de-be15-df09463393a8","nextPostId":"a02d0528-84ff-5573-b188-9292da9a5fda"}},
    "staticQueryHashes": []}